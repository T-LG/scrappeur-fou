require 'rubygems'
require 'nokogiri'
require 'open-uri'

# Déclaration de la page à scrapper
def get_page
  return Nokogiri::HTML(open("https://coinmarketcap.com/all/views/all/"))
end 

# Collecte des symboles des cryptomonnaies
def scrapp_symbols
  symbols = get_page.xpath('//*[@class="text-left col-symbol"]')
  symbols_array = [] #/ initialisation d'un array pour les stocker
  symbols.each do |symbol| 
    symbols_array << symbol.text 
  end
  return symbols_array
end
cmc-table__cell cmc-table__cell--sortable cmc-table__cell--left cmc-table__cell--sort-by__symbol
# Collecte des cours des cryptomonnaies
def scrapp_prices
  prices = get_page.xpath('//*[@class="price"]')
  prices_array = []
  prices.each do |price|
    prices_array << price.text[1..-1].to_f
  end
  return prices_array
end 

# Association des symboles de cryptomonnaies à leurs cours respectifs
def crypto_master
  symbols_array = scrapp_symbols 
  prices_array = scrapp_prices 
  a = []
  symbols_array.each_with_index do |k, v|
    a << {k => (prices_array)[v]} 
    print "Ajout de: #{a[:k]}"
  end
  print "Tableau: #{a}"
  return a
end


crypto_master
